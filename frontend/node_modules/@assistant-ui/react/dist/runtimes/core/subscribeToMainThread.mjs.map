{"version":3,"sources":["../../../src/runtimes/core/subscribeToMainThread.ts"],"sourcesContent":["import { Unsubscribe } from \"../../types\";\nimport { AssistantRuntimeCore } from \"./AssistantRuntimeCore\";\n\n/**\n * @deprecated Use `runtime.thread.subscribe` instead. This will be removed in 0.6.0.\n */\nexport const subscribeToMainThread = (\n  runtime: AssistantRuntimeCore,\n  callback: () => void,\n) => {\n  let first = true;\n  let cleanup: Unsubscribe | undefined;\n  const inner = () => {\n    cleanup?.();\n    cleanup = runtime.threadList.mainThread.subscribe(callback);\n\n    if (!first) {\n      callback();\n    }\n    first = false;\n  };\n\n  const unsubscribe = runtime.threadList.mainThread.subscribe(inner);\n  inner();\n\n  return () => {\n    unsubscribe();\n    cleanup?.();\n  };\n};\n"],"mappings":";AAMO,IAAM,wBAAwB,CACnC,SACA,aACG;AACH,MAAI,QAAQ;AACZ,MAAI;AACJ,QAAM,QAAQ,MAAM;AAClB,cAAU;AACV,cAAU,QAAQ,WAAW,WAAW,UAAU,QAAQ;AAE1D,QAAI,CAAC,OAAO;AACV,eAAS;AAAA,IACX;AACA,YAAQ;AAAA,EACV;AAEA,QAAM,cAAc,QAAQ,WAAW,WAAW,UAAU,KAAK;AACjE,QAAM;AAEN,SAAO,MAAM;AACX,gBAAY;AACZ,cAAU;AAAA,EACZ;AACF;","names":[]}